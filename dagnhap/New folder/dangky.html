<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="dangky.css" />
    <title>Đăng ký</title>
  </head>
  <body>
    <div class="container">
      <h1>Tạo tài khoản mới</h1>

      <div class="form-register">
        <!-- Họ tên -->
        <div class="full-name">
          <input type="text" id="firstname" placeholder="Họ" />
          <input type="text" id="lastname" placeholder="Tên" />
        </div>

        <!-- Email / SĐT -->
        <div class="email">
          <input
            type="text"
            id="email"
            placeholder="Số điện thoại hoặc email"
          />
        </div>

        <!-- Mật khẩu -->
        <div class="password">
          <input type="password" id="password" placeholder="Mật khẩu mới" />
        </div>

        <!-- Ngày sinh -->
        <div class="birthday">
          <p class="font-sub">Ngày sinh</p>
          <div class="c-birthday">
            <div class="day">
              <select id="day">
                <option value="">Ngày</option>
              </select>
            </div>
            <div class="month">
              <select id="month">
                <option value="">Tháng</option>
              </select>
            </div>
            <div class="year">
              <select id="year">
                <option value="">Năm</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Giới tính -->
        <div class="sex">
          <label class="font-sub">Giới tính</label>
          <div class="f-sex">
            <div>
              <input type="radio" name="gender" id="male" value="Nam" />
              <label for="male">Nam</label>
            </div>
            <div>
              <input type="radio" name="gender" id="female" value="Nữ" />
              <label for="female">Nữ</label>
            </div>
          </div>
        </div>

        <!-- Nút đăng ký -->
        <div class="btn-register">
          <button id="btnRegister">Đăng ký</button>
        </div>
        <p style="text-align: center; margin-top: 10px">
          Bạn đã có tài khoản? <a href="dangnhap.html">Đăng nhập</a>
        </p>
      </div>
    </div>

    <script>
      // Tạo danh sách ngày/tháng/năm
      const daySelect = document.getElementById("day");
      const monthSelect = document.getElementById("month");
      const yearSelect = document.getElementById("year");

      for (let d = 1; d <= 31; d++)
        daySelect.innerHTML += `<option value="${d}">${d}</option>`;
      for (let m = 1; m <= 12; m++)
        monthSelect.innerHTML += `<option value="${m}">${m}</option>`;
      const currentYear = new Date().getFullYear();
      for (let y = currentYear; y >= 1900; y--)
        yearSelect.innerHTML += `<option value="${y}">${y}</option>`;

      // Xử lý khi nhấn Đăng ký
      document
        .getElementById("btnRegister")
        .addEventListener("click", function (e) {
          e.preventDefault();

          const firstname = document.getElementById("firstname").value.trim();
          const lastname = document.getElementById("lastname").value.trim();
          const email = document.getElementById("email").value.trim();
          const password = document.getElementById("password").value.trim();
          const day = parseInt(daySelect.value);
          const month = parseInt(monthSelect.value);
          const year = parseInt(yearSelect.value);
          const genderInput = document.querySelector(
            'input[name="gender"]:checked'
          );
          const gender = genderInput ? genderInput.value : "";

          // Kiểm tra thông tin trống
          if (
            !firstname ||
            !lastname ||
            !email ||
            !password ||
            !day ||
            !month ||
            !year ||
            !gender
          ) {
            alert("Vui lòng nhập đầy đủ thông tin!");
            return;
          }

          // Kiểm tra ngày hợp lệ
          const daysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
          if ((year % 4 === 0 && year % 100 !== 0) || year % 400 === 0)
            daysInMonth[1] = 29;
          if (day > daysInMonth[month - 1]) {
            alert(`Ngày ${day}/${month}/${year} không hợp lệ!`);
            return;
          }

          // Kiểm tra email đã tồn tại
          if (localStorage.getItem(email)) {
            alert("Tài khoản này đã tồn tại, vui lòng đăng nhập!");
            window.location.href = "dangnhap.html";
            return;
          }

          // Lưu thông tin người dùng
          const user = {
            firstname,
            lastname,
            email,
            password,
            birthday: `${day}/${month}/${year}`,
            gender,
          };
          localStorage.setItem(email, JSON.stringify(user));

          alert("Đăng ký thành công! Hãy đăng nhập lại nhé!");
          window.location.href = "dangnhap.html";
        });
    </script>
  </body>
</html>
